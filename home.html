<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Blue Chess.in ‚Äì Home</title>
    <meta name="description" content="Welcome to Blue Chess.in! Play online chess against bots, friends, or real players worldwide. Fast, fun, and completely free.">
    <link rel="shortcut icon" href="files/img/-s-logo.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #88c6ff;
        }
        .container {
            display: flex;
            height: 100vh;
        }
        .sidebar {
            width: 250px;
            background-color: #0069d2;
            color: white;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        .sidebar h1 {
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
        }
        .menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .menu button {
            background-color: white;
            color: #0055a9;
            border: none;
            padding: 10px;
            font-size: 1em;
            cursor: pointer;
            border-radius: 5px;
            text-align: left;
        }
        .menu button:hover {
            background-color: #ddd;
        }
        .main {
            flex: 1;
            padding: 20px;
            background-color: white;
        }
        .main h2 {
            text-align: center;
            margin-bottom: 20px;
        }
        .chessboard-img {
            display: block;
            margin: 0 auto;
            max-width: 600px;
            width: 100%;
        }
        .logo {
            width: 250px;
            margin: 0 auto 20px;
            display: block;
        }
    </style>
</head>
<body>
<div class="container">
    <!-- Sidebar -->
    <div class="sidebar">
        <img src="files/img/-w-logo.png" alt="Blue Chess.in" class="logo">
        <div class="menu">
            <button onclick="window.location.href='profile.html'" id="profileBtn">Profile (<span id="username">Loading...</span>)</button>
            <button onclick="location.href='bots.html'">ü§ñ Play Bot!</button>
            <button onclick="window.location.href='off-game.html'">üèÅ Play Offline</button>
            <button onclick="window.location.href='online-game.html'" >‚ôï Online Play</button>
            <button onclick="window.location.href='shop.html'" >üõí The Shop</button>
            <button onclick="window.location.href='learnchess.html'"> ? How to Play</button>
            <button id="logoutBtn">Logout</button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main">
        <h2>Play Chess against bots and friends!</h2>
        <img src="files/img/chessboard1.png" alt="Chessboard" class="chessboard-img">
    </div>
</div>

<script>
const SUPABASE_URL = "https://ruevzmnbhoowmuleeqjb.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ1ZXZ6bW5iaG9vd211bGVlcWpiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzOTUzNTIsImV4cCI6MjA2OTk3MTM1Mn0.tt_xEAqLGiv92mvqhQaEvsjTBE6cmYDC3kkQcyPqsTY";
const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

async function checkAuth() {
  // 1. Check maintenance mode
  const { data: settings, error: settingsError } = await supabaseClient
    .from("settings")
    .select("maintenance, message")
    .limit(1)
    .maybeSingle();

  if (settingsError) {
    console.error("Error loading settings:", settingsError.message);
  }

  if (settings?.maintenance) {
    window.location.href = "maintenance.html";
    return;
  }

  // 2. Check auth
  const { data: { user }, error: authError } = await supabaseClient.auth.getUser();
  if (authError || !user) {
    window.location.href = "index.html";
    return;
  }

  // 3. Fetch profile
  const { data: profileRow, error: profileError } = await supabaseClient
    .from("profiles")
    .select("username, banned")
    .eq("id", user.id)
    .single();

  if (profileError) {
    console.error("Error fetching profile:", profileError.message);
  }

  if (profileRow?.banned) {
    window.location.href = "banned.html";
    return;
  }

  // ‚úÖ If everything fine ‚Üí show username somewhere
  document.getElementById("welcomeText").textContent =
    "Welcome, " + (profileRow?.username || user.email);
}

// Run on page load
checkAuth();
</script>

</body>
</html>





